<?php

/**
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class Hotel extends BaseHotel {
    public function setUp() {
        parent::setUp();
        $this->hasOne('XUser as GeaendertVon', array (
            'local'=>'geaendert_von',
            'foreign'=>'id',
            )
        );
        $this->hasMany('HotelBuchung as Buchungen', array (
            'local'=>'id',
            'foreign'=>'hotel_id',
            )
        );

        $this->hasMany("HotelPreis as HotelPreise", array (
            'local' => "id",
            'foreign' => "hotel_id"
        ));

        $this->hasOne("Standort as Standort", array (
            'local' => "standort_id",
            "foreign" => "id"
        ));
        public function setUp() {
			$this->actAs("ChangeCounted");
		}

    }

    function autocompleteTableProxy ( $name ) {
        $q = Doctrine_Query::create()
            ->from("ViewHotelPreis hotel")
            ->select ("hotel.name, hotel._id, hotel.ort, hotel.zimmerpreis_ez, hotel.zimmerpreis_dz," .
                "hotel.zimmerpreis_mb46, hotel.marge, hotel.fruehstuecks_preis")
            ->where ("hotel.name LIKE ?",  $name . "%")
            ->andWhere("hotel.datum_start = ?","0000-00-00")
            ->andWhere("hotel.datum_ende = ?","0000-00-00")
			->groupBy("hotel._id");
        return $q;
    }

    function remoteListTableProxy() {
        $q = Doctrine_Query::create()
            ->from('ViewHotelPreis hotel')
            ->leftJoin("hotel.Standort standort")
            ->leftJoin("hotel.HotelPreise hotelpreis")
	    ->groupBy("hotel._id");

        return $q;
    }

    function remoteObjectTableProxy($id) {
        $q = Doctrine_Query::create()
            ->from('Hotel hotel')
	    ->where ("hotel.id = ?", $id);

        return $q;
    }



}
?>